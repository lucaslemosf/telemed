<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="utf-8">
  <title>Sisteminha de Telemed</title>
  <link href="https://fonts.googleapis.com/css?family=Nunito" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>

  <div id="login_div" class="notloggedin-div">
    <h3><a href="auth/index.html">Login</a></h3>
  </div>

  <div id="loggedin_div" class="loggedin-div">
    <h3 id="user_h3">Bem-Vindo</h3>
    <button onclick="loggout()">Loggout</button>
  </div>

  <script src="https://www.gstatic.com/firebasejs/4.13.0/firebase.js"></script>
  <script>
    //TODO: isso devia estar no style.css
    document.getElementById("login_div").style.display = "none";
    document.getElementById("loggedin_div").style.display = "none";
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyDAXBlqr1ruV6CKAV7ROmThtNINOz3_ICg",
      authDomain: "telemedicina-5e24d.firebaseapp.com",
      databaseURL: "https://telemedicina-5e24d.firebaseio.com",
      projectId: "telemedicina-5e24d",
      storageBucket: "",
      messagingSenderId: "343042999075"
    };
    firebase.initializeApp(config);
    // TODO: Eu deverica colocar isso num script separado, mas to com pregui√ßa
    firebase.auth().onAuthStateChanged(function(user) {
      var name, email, photoUrl, uid, emailVerified;
      if (user) {
        // User is signed in.
          document.getElementById("login_div").style.display = "none";
          document.getElementById("loggedin_div").style.display = "initial";

          name = user.displayName;
          email = user.email;
          photoUrl = user.photoURL;
          emailVerified = user.emailVerified;
          uid = user.uid;  // The user's ID, unique to the Firebase project. Do NOT use
                           // this value to authenticate with your backend server, if
                           // you have one. Use User.getToken() instead.
           document.getElementById("user_h3").innerHTML =
           "Bem-vindo " + email + ".";
        } else {
        // No user is signed in.
          document.getElementById("login_div").style.display = "initial";
          document.getElementById("loggedin_div").style.display = "none";
        }
    });
    function loggout(){
      firebase.auth().signOut().then(function() {
      // Sign-out successful.
      }).catch(function(error) {
        // An error happened.
        // var errorCode = error.code;
        var errorMessage = error.message;
        window.alert("Error: " + errorCode + "\n" + errorMessage);
      });
    }
  </script>

</body>

</html>
